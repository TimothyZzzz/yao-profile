function setupCalendar() {
  function updateCalendar() {
    const now = new Date();
    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    const year = now.getFullYear();
    const month = now.getMonth() + 1;
    const date = now.getDate();
    const dayOfWeek = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'][now.getDay()];
    const isoWeek = getISOWeek(now);

    // æ˜¾ç¤ºå…¬å†
    document.getElementById('dateDisplay').textContent = 
      `${year} å¹´ ${month} æœˆ ${date} æ—¥ æ˜ŸæœŸ${dayOfWeek}`;
    document.getElementById('lunarDisplay').textContent = 
      `å†œå†${year}å¹´ Â· ç”Ÿè‚–è›‡ Â· ç¬¬${isoWeek}å‘¨`;

    // å‘å·¥èµ„å€’è®¡æ—¶ï¼ˆæ¯æœˆ10å·ï¼‰
    let payDate = new Date(year, month - 1, 10);
    if (today > payDate) payDate = new Date(year, month, 10);
    const salaryDiff = Math.floor((payDate - today) / (1000 * 60 * 60 * 24));
    document.getElementById('salaryCountdown').textContent = 
      salaryDiff === 0 ? 'ä»Šå¤©å‘å·¥èµ„ï¼ğŸ‰' : `${salaryDiff} å¤©`;

    // ===== åŠ¨æ€èŠ‚æ—¥åˆ—è¡¨ï¼ˆæ”¯æŒè‡ªåŠ¨è·¨å¹´ï¼‰=====
    const holidays = [
      { id: 'newYear',     name: 'å…ƒæ—¦',        month: 0,   day: 1   },  // 1æœˆ1æ—¥
      { id: 'spring',      name: 'æ˜¥èŠ‚',        month: 1,   day: 8   },  // æ³¨æ„ï¼š2027å¹´æ˜¥èŠ‚æ˜¯2æœˆ8æ—¥ï¼ˆå†œå†æ­£æœˆåˆä¸€ï¼‰
      { id: 'qingming',    name: 'æ¸…æ˜èŠ‚',      month: 3,   day: 4   },  // æ¸…æ˜é€šå¸¸åœ¨4æœˆ4æ—¥æˆ–5æ—¥ï¼Œå–4æœˆ4æ—¥æ›´æ—©è§¦å‘
      { id: 'labor',       name: 'åŠ³åŠ¨èŠ‚',      month: 4,   day: 1   },
      { id: 'dragonBoat',  name: 'ç«¯åˆèŠ‚',      month: 5,   day: 30  },  // ç«¯åˆä¸ºå†œå†äº”æœˆåˆäº”ï¼Œ2027å¹´å¯¹åº”6æœˆ30æ—¥
      { id: 'midAutumn',   name: 'ä¸­ç§‹èŠ‚',      month: 9,   day: 6   },  // 2027å¹´ä¸­ç§‹æ˜¯10æœˆ6æ—¥ï¼ˆå†œå†å…«æœˆåäº”ï¼‰
      { id: 'national',    name: 'å›½åº†èŠ‚',      month: 9,   day: 1   }
    ];

    // å½“å‰å¹´ä»½å’Œä¸‹ä¸€å¹´
    const currentYear = now.getFullYear();
    const nextYear = currentYear + 1;

    holidays.forEach(h => {
      // æ„é€ ä»Šå¹´çš„èŠ‚æ—¥
      let holidayDate = new Date(currentYear, h.month, h.day);
      
      // å¦‚æœä»Šå¹´å·²è¿‡ï¼Œåˆ™ç”¨ä¸‹ä¸€å¹´
      if (today > holidayDate) {
        holidayDate = new Date(nextYear, h.month, h.day);
      }

      const diff = Math.floor((holidayDate - today) / (1000 * 60 * 60 * 24));
      const elem = document.getElementById(`countdown${h.id}`);
      if (elem) {
        elem.textContent = `${diff} å¤©`;
      }
    });
  }

  updateCalendar();
  setInterval(() => {
    const now = new Date();
    if (now.getSeconds() === 0 && [0, 30].includes(now.getMinutes())) {
      updateCalendar(); // æ¯åŠå°æ—¶åˆ·æ–°ä¸€æ¬¡
    }
  }, 60000);
}
